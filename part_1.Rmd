---
title: "Project part 1"
output: html_document
date: "2022-08-24"
---
### Load Packages
```{r}
library(here)
library(tidyverse)
library(lubridate)
```


### Read in Data
```{r}

## Data lives only on taylor server - need absolute file path to access
BQ1 <- read_csv("/courses/EDS214/killer_whales/data/raw_data/csv/QuebradaCuenca1-Bisley.csv", na = "-9999")
BQ2 <- read_csv("/courses/EDS214/killer_whales/data/raw_data/csv/QuebradaCuenca2-Bisley.csv", na = "-9999")
BQ3 <- read_csv("/courses/EDS214/killer_whales/data/raw_data/csv/QuebradaCuenca3-Bisley.csv", na = "-9999")
PRM <- read_csv("/courses/EDS214/killer_whales/data/raw_data/csv/RioMameyesPuenteRoto.csv", na = "-9999")


bq2 <- BQ2 %>% 
  mutate(Sample_Date = as.Date(mdy_hm(Sample_Date)))
bq1 <- BQ1 %>% 
  mutate(Sample_Date = mdy(Sample_Date))
bq3 <- BQ3 %>% 
  mutate(Sample_Date = mdy(Sample_Date))
prm <- PRM %>% 
  mutate(Sample_Date = mdy(Sample_Date))


```

## Fixing Q2 date column

```{r}

## Combine into one dataframe
large_df <- rbind(bq1, bq2, bq3, prm)
```



```{r}

large_subset <- large_df %>% 
  select(Sample_ID, Sample_Date, NO3, K) %>% 
  rename(id = 1, date = 2, no3 = 3, k = 4) %>% 
  mutate(year = year(date)) %>% 
  mutate(month = month(date)) %>% 
  filter(year >= 1988 & year <= 1994) %>% 
  group_by(year, month, id) %>% 
  summarise(mean = mean(k, na.rm=TRUE)) 
  
  

ggplot(large_subset, aes(x = year, y = mean)) + geom_line(aes(color = id))
```

